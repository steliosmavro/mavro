---
title: "Working at Scale: Engineering Lessons from InstaShop's $360M Journey"
date: "2024-11-20"
summary: "Two years of building systems that serve millions of users across MENA. From API integrations to firefighting production issues, here's what I learned working at a unicorn startup acquired by Delivery Hero."
tags: ["Scale", "Enterprise", "Node.js", "Kafka", "MongoDB", "AWS"]
relatedProject: null
---

When I joined InstaShop in January 2023, I knew I was stepping into something big. The leading grocery delivery app in MENA had just been acquired by Delivery Hero for $360 million. What I didn't know was how much this experience would transform my approach to software engineering.

## The Scale Challenge

InstaShop wasn't just another delivery app. We were handling:
- Millions of orders per month
- Real-time inventory across thousands of stores
- Sub-30-minute delivery promises
- Operations across multiple countries
- Integration with Delivery Hero's global infrastructure

Every line of code had to be production-ready. There was no "we'll fix it later."

## My Journey Through Three Critical Teams

### 1. Integration Team: Building Bridges at Scale

My first challenge was building APIs for external partners. This wasn't your typical REST API project:

```typescript
// Handling millions of events per day
const eventProcessor = {
  orderCreated: async (event) => {
    await validatePartnerQuota(event.partnerId);
    await enrichOrderData(event);
    await publishToKafka(event);
    await notifyWebhooks(event);
  }
};
```

**Key Lessons:**
- **Idempotency is non-negotiable**: Every API must handle duplicate requests gracefully
- **Rate limiting saves lives**: Partners will accidentally DDoS you
- **Versioning from day one**: Breaking changes are inevitable
- **Document everything**: Your API is only as good as its documentation

### 2. Admin Dashboard: Internal Tools at Enterprise Scale

Building internal tools taught me that your colleagues are your most demanding users:

```typescript
// Processing 100K+ records without killing the browser
const DataExporter = {
  async exportLargeDataset(query) {
    const batchSize = 1000;
    const totalCount = await db.count(query);
    
    // Stream to S3 instead of memory
    const stream = new PassThrough();
    const upload = s3.upload({ 
      Bucket: 'exports',
      Key: `export-${Date.now()}.csv`,
      Body: stream 
    });
    
    // Process in batches
    for (let offset = 0; offset < totalCount; offset += batchSize) {
      const batch = await db.find(query).skip(offset).limit(batchSize);
      stream.write(convertToCSV(batch));
    }
    
    stream.end();
    return upload.promise();
  }
};
```

**What I Built:**
- Automation tools that saved 50+ hours per week
- Scheduled jobs for recurring tasks
- Real-time dashboards for operations teams
- Bulk data processing without performance degradation

### 3. Firefighting Team: When Production Burns

Being on the firefighting team was like being a digital first responder. When production had issues, we were the ones who fixed it.

**A Day in the Life:**
```
06:00 - Alert: Order processing delay in UAE
06:15 - Identified: MongoDB replica lag
06:30 - Mitigation: Route reads to primary
07:00 - Fix deployed, monitoring recovery
08:00 - Post-mortem meeting
09:00 - Implement preventive measures
```

**Critical Skills Developed:**
- **Log Analysis**: CloudWatch and Datadog became extensions of my brain
- **Quick Decision Making**: Sometimes a band-aid now is better than surgery later
- **Communication**: Explaining technical issues to non-technical stakeholders
- **Pressure Management**: Staying calm when revenue is dropping by the minute

## Technical Architecture Insights

### Kafka: The Backbone of Everything

InstaShop's event-driven architecture taught me the power of Kafka:

```typescript
// Producer with proper error handling
class ResilientProducer {
  async publish(topic: string, event: any) {
    const maxRetries = 3;
    let lastError;
    
    for (let i = 0; i < maxRetries; i++) {
      try {
        await this.kafka.send({
          topic,
          messages: [{
            key: event.orderId,
            value: JSON.stringify(event),
            headers: {
              'correlation-id': generateCorrelationId(),
              'retry-count': i.toString()
            }
          }]
        });
        return;
      } catch (error) {
        lastError = error;
        await this.backoff(i);
      }
    }
    
    // Send to DLQ
    await this.sendToDeadLetter(topic, event, lastError);
  }
}
```

### MongoDB at Scale

Working with MongoDB containing billions of documents taught me:
- Indexes are your best friend and worst enemy
- Aggregation pipelines can replace entire microservices
- Sharding is inevitable at scale
- Read preferences matter more than you think

### Apache Druid for Analytics

Real-time analytics on millions of events:
```sql
SELECT 
  TIME_FLOOR(__time, 'PT1H') as hour,
  city,
  COUNT(*) as orders,
  AVG(delivery_time) as avg_delivery,
  SUM(order_value) as revenue
FROM orders
WHERE __time >= CURRENT_TIMESTAMP - INTERVAL '24' HOUR
GROUP BY 1, 2
```

## Cultural Learnings

### Working in a 60+ Developer Team

- **Code reviews are sacred**: Every PR was a learning opportunity
- **Documentation is code**: If it's not documented, it doesn't exist
- **Ownership matters**: You build it, you run it, you fix it
- **Communication scales**: Over-communicate in large teams

### The Acquisition Impact

Working through the Delivery Hero integration taught me:
- Technical debt becomes very real during acquisitions
- Standards matter when integrating with global systems
- Legacy code is often legacy for good reasons
- Change management is as important as code quality

## Personal Growth

### From Feature Developer to System Thinker

Before InstaShop, I thought in features. After InstaShop, I think in systems:
- How will this scale to 10x load?
- What happens when this service is down?
- How do we monitor this in production?
- What's the rollback plan?

### Technical Skills Gained

- **Distributed Systems**: Understanding CAP theorem in practice
- **Performance Optimization**: From query optimization to caching strategies
- **Monitoring & Observability**: If you can't measure it, you can't improve it
- **Incident Response**: Staying calm under pressure

## Key Takeaways

1. **Scale changes everything**: Algorithms that work for thousands fail for millions
2. **Resilience over perfection**: Systems fail; plan for it
3. **Team work at scale**: Individual brilliance < coordinated teamwork
4. **Learn from incidents**: Every outage is a learning opportunity
5. **Automate ruthlessly**: If you do it twice, automate it

## The Tools That Saved Us

- **DataDog**: For when you need to find that one log among billions
- **PagerDuty**: Because incidents don't respect sleep schedules
- **Kafka**: The reliable message broker that never let us down
- **Redis**: When MongoDB was too slow
- **AWS CloudWatch**: For when you need to know why your bill is so high

## Looking Back

My time at InstaShop transformed me from a developer who could build features to an engineer who could build systems. The late-night incidents, the pressure of millions of users depending on your code, the joy of solving problems at scale - it all contributed to who I am as an engineer today.

The $360M acquisition wasn't just a business success; it validated our technical decisions and the systems we built. When Delivery Hero's engineers reviewed our code and architecture, their approval meant everything.

## What This Means for My Future Work

Every project I work on now benefits from the InstaShop experience:
- I architect for scale from day one
- I build with monitoring in mind
- I document as I code
- I plan for failure
- I value simplicity over cleverness

Working at InstaShop wasn't just a job; it was an intensive masterclass in building systems that millions depend on. And that's a responsibility I carry forward in everything I build.